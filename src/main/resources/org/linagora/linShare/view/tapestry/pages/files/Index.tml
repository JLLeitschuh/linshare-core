<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<t:MyBorderLayout t:title="message:pages.files.index.title" t:identifier="files" t:currentHighlight="files"
	xmlns:t="http://tapestry.apache.org/schema/tapestry_5_0_0.xsd">

    <script type="text/javascript" language="javaScript">
        function processUploadCompleteEvent(message) {
            setTimeout(submitShare, 1000);
        }

        function submitShare() {
            location.reload(true);
        }
    </script>
	<!-- Main content -->

	<div id="content">

		<h1>${message:components.myborderlayout.file.title}</h1>


		<!-- Message panel -->

		<div id="messagePanel">
			<ul>
				<t:loop t:source="prop:messagesInfo" t:value="currentMessage">
				<li>${currentMessage}</li>
				</t:loop>
			</ul>
		</div><!-- id="messagePanel" -->
		<t:businessMessagesDisplayer />


		<!-- Action bar -->

		<div id="actionBar">
			<h4>Actions</h4>
			<ul>
				<t:if test="userVo.upload">
				<li>
					<a href="#" class="button" onclick="windowUpload.showCenter(true);">
						<span><img src="${asset:context:images/icons/icon-add-files.png}" alt=""/>
							${message:pages.files.upload.addbutton}</span>
					</a>
				</li>
				</t:if>
				<t:if test="userVo.upload" negate="true">	<t:linkit.Comment> * KEEP IT, XHTML validation * </t:linkit.Comment>
				<li>&nbsp;</li>
				</t:if>
				<!--li>
					<a href="#" class="button" onclick="quickShareWindow.showCenter(true);">
						<span><img src="${asset:context:images/icons/share-on-small.png}" alt=""/>
							${message:pages.files.quickshare.button}</span>
					</a>
				</li-->
			</ul>
		</div><!-- id="actionBar" -->


		<!-- Page content -->

		<div id="pageContent">

			<!-- List : Search result -->

			<t:ListDocument t:documents="listDocumentsVo" t:user="userVo" />

		</div>

	</div><!-- id="content" -->



	<!-- Popups -->

	<!-- Confirm share popup -->
	<t:confirmSharePopup t:messageLabel="${message:pages.user.fileSearch.messageConfirm}"
		t:eventName="sharePopupEvent" t:usersVo="prop:shareSessionObjects.users"
		t:documentsVo="prop:shareSessionObjects.documents" />

	<!-- Uploader popup -->
	<div t:id="windowUpload">
		<t:fileUploader divId="literal:sendFiles" showsendbutton="literal:true"/>
		<div class="closeUploadPopup">
			<a id="closeUploadPopupNow" href="#" onclick='location.reload(true)' style="visibility:hidden">${message:pages.files.closeUploadPopup}</a>
		</div>
	</div>

	<!-- Quick share popup -->
	<!--t:quickSharePopup t:eventName="sharePopupEvent" /-->



	<!-- Widgets -->

	<!-- Search widget -->
	<t:parameter name="searchWidget">
		<t:widget widgetId="searchWidget" title="${message:components.widget.searchWidget.title}">
			<t:SearchFile userlogin="userVo" />
		</t:widget>
	</t:parameter>
	
	<!-- Actions widget -->
	<t:parameter name="actionsWidget">
		<t:if test="listDocumentsVo">
			<t:widget widgetId="actionsWidget" title="${message:components.widget.actionsWidget.title}">
				<t:actionsBarDocument t:user="userVo" t:formName="search" />
			</t:widget>
		</t:if>
	</t:parameter>
	
	<!-- Share widget -->
	<t:parameter name="shareWidget">
		<t:if test="shareSessionObjects.notEmpty">
			<t:widget widgetId="shareWidget" title="${message:components.widget.shareWidget.title}">
				<t:sharePanel listObject="prop:shareSessionObjects.documents" columns="fileName"
					label="${message:pages.user.fileSearch.sharePanel.label}" />
			</t:widget>
		</t:if>
	</t:parameter>


</t:MyBorderLayout>
