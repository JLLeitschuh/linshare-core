<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<t:MyBorderLayout t:title="message:pages.files.upload.title" t:identifier="share" t:currentHighlight="files"
	xmlns:t="http://tapestry.apache.org/schema/tapestry_5_1_0.xsd" xmlns:p="tapestry:parameter">

    <script type="text/javascript" language="javascript">
        var trySubmit = function() {
            jQuery(".spinner").show();
            jQuery("#formShareSubmit").hide();
            jQuery("#submitShare").click();
        }

        jQuery(document).ready(function() {
            // init
            jQuery(".spinner").hide();
        })
    </script>


    <!-- Main content -->
    <div id="content">
        <h1>${message:pages.files.upload.title}</h1>
            <t:businessMessagesDisplayer />
            <t:messagePanel />

        <t:grid source="documents" include="fileName, creationDate" row="document">
            <t:parameter t:name="fileNameCell">
                <t:if t:test="${document.fileComment}">
                    <span t:type="ck/Tooltip" title="${message:components.listDocument.picture.tooltip.title}" value="${formatedComment}">
                        <img style="margin-right:10px;" src="${asset:context:images/icons/pin.png}" />
                    </span>
                </t:if>  <t:if t:test="${document.fileComment}" negate="true">
                    <span style="margin-right:10px;">
                        <img src="${asset:context:images/icons/pingray.png}"/>
                    </span>
                </t:if>
                <t:actionLink t:id="download"
                    t:context="${document.identifier}" t:type="${document.type}"
                    class="fileName ${typeCSSClass}">${document.fileName}
                </t:actionLink>
            </t:parameter>
        </t:grid>

        <h2>${message:pages.files.upload.share.title}</h2>

        <t:form t:id="shareForm" class="form-horizontal">
            <fieldset>
              <!--  <t:errors /> -->

                <div class="control-group">
                    <t:label for="recipientsPattern" class="control-label required">
                    ${message:pages.files.upload.recipients.title}</t:label>
                    <div class="controls">
                        <t:textarea t:id="recipientsPattern" t:value="recipientsSearch" t:mixins="autocomplete"
                        t:minChars="${autocompleteMin}" t:tokens="," class="input-xxlarge"
                        onchange="rm_errorclass();" />
                        <p class="help-block">${message:pages.files.upload.recipients.description}</p>
                    </div>
                </div>

                <t:if test="enableListTab">
                    <div class="control-group">
                        <t:label for="mailingLists" class="control-label required">
                        ${message:pages.files.upload.recipientsMailingList.title}</t:label>
                        <div class="controls">
                            <div t:type="tag/tagselect" t:id="mailingLists" t:value="mailingLists"
                            t:encoder="encoder" t:dropdown="false" t:minChars="3" style="width: 535px;"></div>
                            <p class="help-block">${message:pages.files.upload.recipientsMailingList.description}</p>
                        </div>
                    </div>
                </t:if>

                <div class="control-group">
                    <t:if test="showShareExpirationDate">
                        <t:label for="shareExpiryDate" class="control-label">
                        ${message:pages.files.upload.shareExpiryDate}</t:label>
                        <div class="controls">
                            <t:datefield t:id="shareExpiryDate" t:value="shareExpiryDate" t:validate="required" />
                            <span class="help-inline">
                                ${message:pages.files.upload.message.shareExpiration.help}  ${maxLocalizedExpirationDate}</span>
                        </div>
                    </t:if>
                </div>

                <div class="control-group">
                    <t:if test="showSecureSharingCheckBox">
                        <t:label for="secureSharing" class="control-label">
                        ${message:pages.files.upload.secureSharing}</t:label>
                        <div class="controls">
                            <label class="checkbox">
                                <t:checkbox t:id="secureSharing" />
                                <span class="help-inline">
                                ${message:pages.files.upload.message.secureSharing.help}</span>
                            </label>
                        </div>
                    </t:if>
                </div>

                <div class="control-group">
                    <t:if test="showAcknowledgementCheckBox">
                        <t:label for="creationAcknowledgement" class="control-label">
                        ${message:pages.files.upload.creationAcknowledgement}</t:label>
                        <div class="controls">
                            <label class="checkbox">
                                <t:checkbox t:id="creationAcknowledgement" />
                                <span class="help-inline">
                                ${message:pages.files.upload.creationAcknowledgement.description}</span>
                            </label>
                        </div>
                    </t:if>
                </div>
                
                <div class="control-group">
                    <t:if test="showUndownloadedSharedDocumentsAlertCheckbox">
                        <t:label for="enableUndownloadedSharedDocumentsAlert" class="control-label">
                        ${message:pages.files.upload.enableUndownloadedSharedDocumentsAlert}</t:label>
                        <div class="controls">
                            <label class="checkbox">
                                <t:checkbox t:id="enableUndownloadedSharedDocumentsAlert" />
                                <span class="help-inline">
                                ${message:pages.files.upload.enableUndownloadedSharedDocumentsAlert.description}</span>
                            </label>
                        </div>
                    </t:if>
                </div>
                <div class="control-group">
                    <t:if test="showUndownloadedSharedDocumentsNotificationDatePicker">
                             <t:label for="notificationDate" class="control-label">
                                ${message:pages.files.upload.notificationDate}</t:label>
                             <div class="controls">
                                <t:datefield t:id="notificationDate" t:value="notificationDate" t:validate="required" />
                                <span class="help-inline">
                                    <t:if test="${maxLocalizedNotificationDate}">
                                        ${message:pages.files.upload.message.notificationDate.help} ${maxLocalizedNotificationDate}
                                        <p:else>
                                            ${message:pages.files.upload.message.notificationDate.help2}
                                        </p:else>
                                    </t:if>
                                </span>
                             </div>
                    </t:if>
               </div>

                <div class="accordion" id="accordionMessage">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordionMessage"
                            href="#collapseOne">${message:pages.files.upload.shareNote.title}</a>
                        </div>
                        <div id="collapseOne" class="${sharingNoteAccordeonClass}">
                            <div class="accordion-inner">
                                <div class="control-group">
                                    <t:label for="textAreaShareNote" class="control-label">
                                    ${message:pages.files.upload.shareNote.label}</t:label>
                                    <div class="controls">
                                        <t:textarea rows="8" t:id="textAreaShareNote" class="input-xxlarge" />
                                    </div> <!--controls-->
                                </div>
                                <div class="control-group">
                                    <div class="controls">
                                        <p class="help-block">${message:pages.files.upload.shareNote.description}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordionMessage"
                            href="#collapseTwo">${message:pages.files.upload.message.custom}</a>
                        </div>

                        <div id="collapseTwo" class="accordion-body collapse">
                            <div class="accordion-inner">
                                <div class="control-group">
                                    <div class="controls">
                                        <p class="help-block">${message:pages.files.upload.message.description}</p>
                                    </div>
                                </div>

                                <div class="control-group">
                                    <t:label for="textAreaSubjectValue" class="control-label">
                                    ${message:pages.files.upload.subject.title}</t:label>
                                    <div class="controls">
                                        <t:textfield t:id="textAreaSubjectValue" size="100" class="input-xxlarge"
                                        onkeypress="if (event.keyCode == 13) return false;" />
                                    </div>
                                </div>

                                <div class="control-group">
                                    <t:label for="textAreaValue" class="control-label">
                                    ${message:pages.files.upload.message.title}</t:label>
                                    <div class="controls">
                                        <t:textarea rows="8" t:id="textAreaValue" class="input-xxlarge" />
                                    </div> <!--controls-->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-actions" style="background-color: transparent">
                    <t:pageLink page="files" class="btn" onlick="tryReturn()">
                    ${message:pages.files.upload.cancelButton}</t:pageLink>
                    ${message:global.space}
                    <input name="submitShare" id="submitShare" type="submit" style="display:none" />
                    <a id="formShareSubmit" class="btn btn-primary" onclick="trySubmit()">
                        <span><img src="${asset:context:images/icons/share-on-small.png}"
                        alt="" /> ${message:global.button.share.cap}</span>
                    </a>
                    <div class="spinner"></div>
                </div> <!--form-actions-->

            </fieldset>
        </t:form>

    </div>
</t:MyBorderLayout>
